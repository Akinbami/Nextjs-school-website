{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect, useRef } from 'react'; // import ReactQuill from 'react-quill';\n\nimport Link from 'next/link';\nimport Head from 'next/head';\nimport dynamic from 'next/dynamic';\nimport LoadingOverlay from 'react-loading-overlay';\nimport { useCookies } from 'react-cookie';\nimport cookies from 'next-cookies';\nimport fetch from 'isomorphic-unfetch';\nimport { useRouter } from 'next/router';\nimport AdminLayout from '../../components/AdminLayout';\nimport MainNav from '../../components/AdminMainNav'; // import 'react-quill/dist/quill.snow.css'\n// import FormHtmlEditor from '../components/FormHtmlEditor'\n\nconst ReactQuill = false ? require('react-quill') : () => false;\nconst QuillNoSSRWrapper = dynamic(() => import('react-quill'), {\n  ssr: false,\n  loading: () => __jsx(\"p\", null, \"Loading ...\"),\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('react-quill')],\n    modules: ['react-quill']\n  }\n});\nconst POST_API = \"https://6j0n7kx92c.execute-api.us-east-2.amazonaws.com/dev/api/post/create\";\n\nconst CreatePost = props => {\n  const {\n    0: title,\n    1: setTitle\n  } = useState(\"\");\n  const {\n    0: content,\n    1: setContent\n  } = useState(\"\");\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(false);\n  const {\n    0: error,\n    1: setError\n  } = useState(null);\n  const [cookies, setCookie] = useCookies(['token']);\n  const router = useRouter();\n  useEffect(() => {\n    if (props.loggedIn == false) {\n      window.location.href = '/admin/login';\n    }\n  });\n\n  const handleChange = value => {\n    console.log(\"value \", value);\n    setContent(value);\n  };\n\n  const publish = () => {\n    console.log(\"cookies \", cookies);\n    let token = cookies['token'];\n\n    if (title == \"\" || content == \"\") {\n      console.log(\"family\", title, content);\n      setError(\"Empty title or Content\");\n    } else {\n      console.log(\"content \", content);\n      setIsLoading(true);\n      fetch(POST_API, {\n        method: 'POST',\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json',\n          'Authorization': 'Bearer ' + token\n        },\n        body: JSON.stringify({\n          title: title,\n          content: content\n        })\n      }).then(response => response.json()).then(data => {\n        console.log(data);\n        router.push('/admin/posts');\n        setIsLoading(false);\n      }).catch(error => {\n        setIsLoading(false);\n        console.log(error);\n      });\n    }\n  };\n\n  const saveDraft = () => {\n    if (title == \"\" || content == \"\") {\n      setError(\"Empty title of Content\");\n    } else {\n      console.log(\"content \", content);\n      setIsLoading(true);\n    }\n  };\n\n  const modules = {\n    toolbar: [[{\n      'header': '1'\n    }, {\n      'header': '2'\n    }, {\n      'font': []\n    }], [{\n      size: []\n    }], ['bold', 'italic', 'underline', 'strike', 'blockquote'], [{\n      'list': 'ordered'\n    }, {\n      'list': 'bullet'\n    }, {\n      'indent': '-1'\n    }, {\n      'indent': '+1'\n    }], ['link', 'image', 'video'], ['clean']],\n    clipboard: {\n      // toggle to add extra line breaks when pasting HTML:\n      matchVisual: false\n    }\n  };\n  /*\n   * Quill editor formats\n   * See https://quilljs.com/docs/formats/\n   */\n\n  const formats = ['header', 'font', 'size', 'bold', 'italic', 'underline', 'strike', 'blockquote', 'list', 'bullet', 'indent', 'link', 'image', 'video'];\n  return __jsx(LoadingOverlay, {\n    active: isLoading,\n    spinner: true,\n    text: \"Loading your content...\"\n  }, __jsx(AdminLayout, {\n    sidebar: true\n  }, __jsx(\"main\", {\n    className: \"jsx-3488110572\" + \" \" + \"main-content col-lg-10 col-md-9 col-sm-12 p-0 offset-lg-2 offset-md-3\"\n  }, __jsx(MainNav, null), __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"main-content-container container-fluid px-4\"\n  }, error == null ? \"\" : __jsx(\"div\", {\n    role: \"alert\",\n    className: \"jsx-3488110572\" + \" \" + \"alert alert-danger\"\n  }, error), __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"page-header row no-gutters py-4\"\n  }, __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"col-12 col-sm-4 text-center text-sm-left mb-0\"\n  }, __jsx(\"span\", {\n    className: \"jsx-3488110572\" + \" \" + \"text-uppercase page-subtitle\"\n  }, \"Blog Posts\"), __jsx(\"h3\", {\n    className: \"jsx-3488110572\" + \" \" + \"page-title\"\n  }, \"Add New Post\"))), __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"row\"\n  }, __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"col-lg-9 col-md-12\"\n  }, __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"card card-small mb-3\"\n  }, __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"card-body\"\n  }, __jsx(\"form\", {\n    className: \"jsx-3488110572\" + \" \" + \"add-new-post\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    placeholder: \"Your Post Title\",\n    onChange: e => setTitle(e.target.value),\n    className: \"jsx-3488110572\" + \" \" + \"form-control form-control-lg mb-3\"\n  }), __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"add-new-post__editor mb-1\"\n  }, __jsx(QuillNoSSRWrapper, {\n    modules: modules,\n    formats: formats,\n    theme: \"snow\",\n    onChange: handleChange\n  })))))), __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"col-lg-3 col-md-12\"\n  }, __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + 'card card-small mb-3'\n  }, __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"card-header border-bottom\"\n  }, __jsx(\"h6\", {\n    className: \"jsx-3488110572\" + \" \" + \"m-0\"\n  }, \"Categories\")), __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + 'card-body p-0'\n  }, __jsx(\"ul\", {\n    className: \"jsx-3488110572\" + \" \" + \"list-group list-group-flush\"\n  }, __jsx(\"li\", {\n    className: \"jsx-3488110572\" + \" \" + \"list-group-item px-3 pb-2\"\n  }, __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"custom-control custom-checkbox mb-1\"\n  }, __jsx(\"input\", {\n    type: \"checkbox\",\n    id: \"category1\",\n    className: \"jsx-3488110572\" + \" \" + \"custom-control-input\"\n  }), __jsx(\"label\", {\n    htmlFor: \"category1\",\n    className: \"jsx-3488110572\" + \" \" + \"custom-control-label\"\n  }, \"Uncategorized\")), __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"custom-control custom-checkbox mb-1\"\n  }, __jsx(\"input\", {\n    type: \"checkbox\",\n    id: \"category2\",\n    className: \"jsx-3488110572\" + \" \" + \"custom-control-input\"\n  }), __jsx(\"label\", {\n    htmlFor: \"category2\",\n    className: \"jsx-3488110572\" + \" \" + \"custom-control-label\"\n  }, \"Design\")), __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"custom-control custom-checkbox mb-1\"\n  }, __jsx(\"input\", {\n    type: \"checkbox\",\n    id: \"category3\",\n    className: \"jsx-3488110572\" + \" \" + \"custom-control-input\"\n  }), __jsx(\"label\", {\n    htmlFor: \"category3\",\n    className: \"jsx-3488110572\" + \" \" + \"custom-control-label\"\n  }, \"Development\")), __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"custom-control custom-checkbox mb-1\"\n  }, __jsx(\"input\", {\n    type: \"checkbox\",\n    id: \"category4\",\n    className: \"jsx-3488110572\" + \" \" + \"custom-control-input\"\n  }), __jsx(\"label\", {\n    htmlFor: \"category4\",\n    className: \"jsx-3488110572\" + \" \" + \"custom-control-label\"\n  }, \"Writing\")), __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"custom-control custom-checkbox mb-1\"\n  }, __jsx(\"input\", {\n    type: \"checkbox\",\n    id: \"category5\",\n    className: \"jsx-3488110572\" + \" \" + \"custom-control-input\"\n  }), __jsx(\"label\", {\n    htmlFor: \"category5\",\n    className: \"jsx-3488110572\" + \" \" + \"custom-control-label\"\n  }, \"Books\")))))), __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + 'card card-small mb-3'\n  }, __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"card-header border-bottom\"\n  }, __jsx(\"h6\", {\n    className: \"jsx-3488110572\" + \" \" + \"m-0\"\n  }, \"Actions\")), __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + 'card-body p-0'\n  }, __jsx(\"ul\", {\n    className: \"jsx-3488110572\" + \" \" + \"list-group list-group-flush\"\n  }, __jsx(\"li\", {\n    className: \"jsx-3488110572\" + \" \" + \"list-group-item p-3\"\n  }, __jsx(\"span\", {\n    className: \"jsx-3488110572\" + \" \" + \"d-flex mb-2\"\n  }, __jsx(\"i\", {\n    className: \"jsx-3488110572\" + \" \" + \"material-icons mr-1\"\n  }, \"flag\"), __jsx(\"strong\", {\n    className: \"jsx-3488110572\" + \" \" + \"mr-1\"\n  }, \"Status:\"), \" Draft\", __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"custom-control custom-checkbox mb-1 ml-auto\"\n  }, __jsx(\"input\", {\n    type: \"checkbox\",\n    id: \"draft\",\n    className: \"jsx-3488110572\" + \" \" + \"custom-control-input\"\n  }), __jsx(\"label\", {\n    htmlFor: \"draft\",\n    className: \"jsx-3488110572\" + \" \" + \"custom-control-label\"\n  }))), __jsx(\"span\", {\n    className: \"jsx-3488110572\" + \" \" + \"d-flex mb-2\"\n  }, __jsx(\"i\", {\n    className: \"jsx-3488110572\" + \" \" + \"material-icons mr-1\"\n  }, \"visibility\"), __jsx(\"strong\", {\n    className: \"jsx-3488110572\" + \" \" + \"mr-1\"\n  }, \"Visibility:\"), __jsx(\"strong\", {\n    className: \"jsx-3488110572\" + \" \" + \"text-success\"\n  }, \"Public\"), __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"custom-control custom-checkbox mb-1 ml-auto\"\n  }, __jsx(\"input\", {\n    type: \"checkbox\",\n    id: \"visibility\",\n    className: \"jsx-3488110572\" + \" \" + \"custom-control-input\"\n  }), __jsx(\"label\", {\n    htmlFor: \"visibility\",\n    className: \"jsx-3488110572\" + \" \" + \"custom-control-label\"\n  }))), __jsx(\"span\", {\n    className: \"jsx-3488110572\" + \" \" + \"d-flex mb-2\"\n  }, __jsx(\"i\", {\n    className: \"jsx-3488110572\" + \" \" + \"material-icons mr-1\"\n  }, \"calendar_today\"), __jsx(\"strong\", {\n    className: \"jsx-3488110572\" + \" \" + \"mr-1\"\n  }, \"Schedule:\"), \" Now\", __jsx(\"div\", {\n    className: \"jsx-3488110572\" + \" \" + \"custom-control custom-checkbox mb-1 ml-auto\"\n  }, __jsx(\"input\", {\n    type: \"checkbox\",\n    id: \"schedule\",\n    className: \"jsx-3488110572\" + \" \" + \"custom-control-input\"\n  }), __jsx(\"label\", {\n    htmlFor: \"schedule\",\n    className: \"jsx-3488110572\" + \" \" + \"custom-control-label\"\n  }))), __jsx(\"span\", {\n    className: \"jsx-3488110572\" + \" \" + \"d-flex\"\n  }, __jsx(\"i\", {\n    className: \"jsx-3488110572\" + \" \" + \"material-icons mr-1\"\n  }, \"score\"), __jsx(\"strong\", {\n    className: \"jsx-3488110572\" + \" \" + \"mr-1\"\n  }, \"Readability:\"), __jsx(\"strong\", {\n    className: \"jsx-3488110572\" + \" \" + \"text-warning\"\n  }, \"Ok\"))), __jsx(\"li\", {\n    className: \"jsx-3488110572\" + \" \" + \"list-group-item d-flex px-3\"\n  }, __jsx(\"button\", {\n    onClick: saveDraft,\n    className: \"jsx-3488110572\" + \" \" + \"btn btn-sm btn-outline-accent\"\n  }, __jsx(\"i\", {\n    className: \"jsx-3488110572\" + \" \" + \"material-icons\"\n  }, \"save\"), \" Save Draft\"), __jsx(\"button\", {\n    onClick: publish,\n    className: \"jsx-3488110572\" + \" \" + \"btn btn-sm btn-accent ml-auto\"\n  }, __jsx(\"i\", {\n    className: \"jsx-3488110572\" + \" \" + \"material-icons\"\n  }, \"file_copy\"), \" Publish\")))))))), __jsx(\"footer\", {\n    className: \"jsx-3488110572\" + \" \" + \"main-footer d-flex p-2 px-3 bg-white border-top\"\n  }, __jsx(\"ul\", {\n    className: \"jsx-3488110572\" + \" \" + \"nav\"\n  }, __jsx(\"li\", {\n    className: \"jsx-3488110572\" + \" \" + \"nav-item\"\n  }, __jsx(\"a\", {\n    href: \"#\",\n    className: \"jsx-3488110572\" + \" \" + \"nav-link\"\n  }, \"Home\")), __jsx(\"li\", {\n    className: \"jsx-3488110572\" + \" \" + \"nav-item\"\n  }, __jsx(\"a\", {\n    href: \"#\",\n    className: \"jsx-3488110572\" + \" \" + \"nav-link\"\n  }, \"Services\")), __jsx(\"li\", {\n    className: \"jsx-3488110572\" + \" \" + \"nav-item\"\n  }, __jsx(\"a\", {\n    href: \"#\",\n    className: \"jsx-3488110572\" + \" \" + \"nav-link\"\n  }, \"About\")), __jsx(\"li\", {\n    className: \"jsx-3488110572\" + \" \" + \"nav-item\"\n  }, __jsx(\"a\", {\n    href: \"#\",\n    className: \"jsx-3488110572\" + \" \" + \"nav-link\"\n  }, \"Products\")), __jsx(\"li\", {\n    className: \"jsx-3488110572\" + \" \" + \"nav-item\"\n  }, __jsx(\"a\", {\n    href: \"#\",\n    className: \"jsx-3488110572\" + \" \" + \"nav-link\"\n  }, \"Blog\"))), __jsx(\"span\", {\n    className: \"jsx-3488110572\" + \" \" + \"copyright ml-auto my-auto mr-2\"\n  }, \"Copyright \\xA9 2018\", __jsx(\"a\", {\n    href: \"https://designrevision.com\",\n    rel: \"nofollow\",\n    className: \"jsx-3488110572\"\n  }, \"DesignRevision\")))), __jsx(_JSXStyle, {\n    id: \"3488110572\"\n  }, [])));\n};\n\nCreatePost.getInitialProps = async context => {\n  // getting token from cookies\n  const auth_token = cookies(context).token;\n  console.log(\"this is the token \", auth_token);\n  const USER_API = \"https://6j0n7kx92c.execute-api.us-east-2.amazonaws.com/dev/api/user\"; // getting current logged in user with the token\n\n  const headers = {\n    method: 'GET',\n    headers: {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json',\n      'Authorization': 'Bearer ' + auth_token\n    }\n  };\n  const res = await fetch(USER_API, headers);\n  const data = JSON.parse((await res.json()));\n\n  if (data.valid) {\n    console.log(\"valid token\");\n    return {\n      loggedIn: true\n    };\n  } else {\n    console.log(\"invalid token\");\n    return {\n      loggedIn: false\n    };\n  }\n};\n\nexport default CreatePost;","map":null,"metadata":{},"sourceType":"module"}